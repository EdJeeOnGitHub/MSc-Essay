---
title: "sim data"
author: "Ed Jee"
date: "15 January 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown


```{r}
library(dplyr)
library(ggplot2)

create_sim_data <- function(N = 1000,
                            prop_defier = 0.2,
                            beta_defier = -5,
                            beta_complier = 5,
                            intercept_both = 10,
                            sd_both = 5){
  N_defier <- floor(prop_defier*N)
  N_complier <- N - N_defier
  x <- rnorm(N, mean = 10, sd = 10)
  y_defier <- intercept_both + x[1:N_defier]*beta_defier + rnorm(N_defier, mean = 0, sd = sd_both)
  y_complier <- intercept_both + x[(N_defier+1):N]*beta_complier + rnorm(N_complier, mean = 0, sd = sd_both)
  y <- c(y_defier,
         y_complier)
  sim_df <- tibble(x, y)
  return(sim_df)
}
sim_df <- create_sim_data()
```



```{r}
ggplot(sim_df, aes(x = x, y = y)) +
  geom_point()
```



```{r}
library(rstan)
options(mc.cores = parallel::detectCores())
rstan_options(auto_write = TRUE)
```



```{r}
library(rstanarm)
restricted_model <- stan_glm(data = sim_df,
                      y ~ x,
                      prior = normal(5, 10, autoscale = FALSE))
unrestricted_model <- stan_glm(data = sim_df,
                               y ~ x,
                               prior = normal(0, 10, autoscale = FALSE))

```



```{r}
loo_restricted <- loo(restricted_model)
loo_unrestricted <- loo(unrestricted_model)

```


```{r}
compare_models(loo_restricted, loo_unrestricted)
```


